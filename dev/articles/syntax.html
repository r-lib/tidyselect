<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Technical description of tidyselect • tidyselect</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Technical description of tidyselect">
<meta name="robots" content="noindex">
<script defer data-domain="tidyselect.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidyselect</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/tidyselect.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/syntax.html">Technical description of tidyselect</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2022/10/tidyselect-1-2-0/">Version 1.2.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/tidyselect/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Technical description of tidyselect</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-lib/tidyselect/blob/main/vignettes/syntax.Rmd" class="external-link"><code>vignettes/syntax.Rmd</code></a></small>
      <div class="d-none name"><code>syntax.Rmd</code></div>
    </div>

    
    
<p>This is a technical description of the tidyselect syntax.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyselect.r-lib.org">tidyselect</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For better printing</span></span>
<span><span class="va">mtcars</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">iris</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></code></pre></div>
<p>To illustrate the semantics of tidyselect, we’ll use variants of
<code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">dplyr::select()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">dplyr::rename()</a></code> that
return the named vector of locations for the selected or renamed
elements:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">select_loc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/eval_select.html">eval_select</a></span><span class="op">(</span><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">rename_loc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/eval_select.html">eval_rename</a></span><span class="op">(</span><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level2">
<h2 id="sets-of-variables">Sets of variables<a class="anchor" aria-label="anchor" href="#sets-of-variables"></a>
</h2>
<p>The tidyselect syntax is all about <strong>sets</strong> of
variables, internally represented by integer vectors of
<strong>locations</strong>. For example, <code>c(1L, 2L)</code>
represents the set of the first and second variables, as does
<code>c(1L, 2L, 1L)</code>.</p>
<p>If a vector of locations contains duplicates, they are normally
treated as the same element, since they represent sets. An exception to
this occurs with named elements whose names differ. If the names don’t
match, they are treated as different elements in order to allow renaming
a variable to multiple names (see section on Renaming variables).</p>
<p>Today, the syntax of tidyselect is generally designed around Boolean
algebra, i.e. we recommend writing
<code>starts_with("a") &amp; !ends_with("z")</code>. Earlier versions of
tidyselect had more of a flavour of set operations, so that you’d write
<code>starts_with("a") - ends_with("b")</code>. While the set operations
are still supported, and is how tidyselect represents variables
internally, we no longer recommend them because Boolean algebra is easy
for people to understand.</p>
<div class="section level3">
<h3 id="bare-names">Bare names<a class="anchor" aria-label="anchor" href="#bare-names"></a>
</h3>
<p>Within <em>data-expressions</em> (see Evaluation section), bare names
represent their own locations, i.e. a set of size 1. The following
expressions are equivalent:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="va">mpg</span><span class="op">:</span><span class="va">hp</span>, <span class="op">!</span><span class="va">cyl</span>, <span class="va">vs</span><span class="op">)</span></span>
<span><span class="co">#&gt;  mpg  cyl disp   hp drat   wt qsec   vs   am gear carb </span></span>
<span><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11</span></span>
<span></span>
<span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="op">!</span><span class="fl">2</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt;  mpg  cyl disp   hp drat   wt qsec   vs   am gear carb </span></span>
<span><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-operator">The <code>:</code> operator<a class="anchor" aria-label="anchor" href="#the-operator"></a>
</h3>
<p><code>:</code> can be used to select consecutive variables between
two locations. It returns the corresponding sequence of locations.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt;  cyl disp   hp </span></span>
<span><span class="co">#&gt;    2    3    4</span></span></code></pre></div>
<p>Because bare names represent their own locations, it is easy to
select a range of variables:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="va">cyl</span><span class="op">:</span><span class="va">hp</span><span class="op">)</span></span>
<span><span class="co">#&gt;  cyl disp   hp </span></span>
<span><span class="co">#&gt;    2    3    4</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="boolean-operators">Boolean operators<a class="anchor" aria-label="anchor" href="#boolean-operators"></a>
</h3>
<p>The <code>|</code> operator takes the <strong>union</strong> of two
sets:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fu"><a href="../reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"Sepal"</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="../reference/starts_with.html">ends_with</a></span><span class="op">(</span><span class="st">"Width"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sepal.Length  Sepal.Width  Petal.Width </span></span>
<span><span class="co">#&gt;            1            2            4</span></span></code></pre></div>
<p>The <code>&amp;</code> operator takes the
<strong>intersection</strong> of two sets:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fu"><a href="../reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"Sepal"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/starts_with.html">ends_with</a></span><span class="op">(</span><span class="st">"Width"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sepal.Width </span></span>
<span><span class="co">#&gt;           2</span></span></code></pre></div>
<p>The <code>!</code> operator takes the <strong>complement</strong> of
a set:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="../reference/starts_with.html">ends_with</a></span><span class="op">(</span><span class="st">"Width"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sepal.Length Petal.Length      Species </span></span>
<span><span class="co">#&gt;            1            3            5</span></span></code></pre></div>
<p>Taking the intersection with a complement produces a set
<strong>difference</strong>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fu"><a href="../reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"Sepal"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="../reference/starts_with.html">ends_with</a></span><span class="op">(</span><span class="st">"Width"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sepal.Length </span></span>
<span><span class="co">#&gt;            1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dots-and-c">Dots and <code>c()</code><a class="anchor" aria-label="anchor" href="#dots-and-c"></a>
</h3>
<p>tidyselect functions can take dots, like
<code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">dplyr::select()</a></code>, or a named argument, like
<code>tidyr::pivot_longer()</code>. In the latter case, the dots syntax
is accessible via <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>. In fact <code>...</code> syntax is
implemented through <code>c(...)</code> and is thus completely
equivalent.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="va">mpg</span>, <span class="va">disp</span><span class="op">:</span><span class="va">hp</span><span class="op">)</span></span>
<span><span class="co">#&gt;  mpg disp   hp </span></span>
<span><span class="co">#&gt;    1    3    4</span></span>
<span></span>
<span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">disp</span><span class="op">:</span><span class="va">hp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  mpg disp   hp </span></span>
<span><span class="co">#&gt;    1    3    4</span></span></code></pre></div>
<p><code>c(x, y, z)</code> is a equivalent to
<code>x | y | z</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fu"><a href="../reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"Sepal"</span><span class="op">)</span>, <span class="fu"><a href="../reference/starts_with.html">ends_with</a></span><span class="op">(</span><span class="st">"Width"</span><span class="op">)</span>, <span class="va">Species</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sepal.Length  Sepal.Width  Petal.Width      Species </span></span>
<span><span class="co">#&gt;            1            2            4            5</span></span>
<span></span>
<span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fu"><a href="../reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"Sepal"</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="../reference/starts_with.html">ends_with</a></span><span class="op">(</span><span class="st">"Width"</span><span class="op">)</span> <span class="op">|</span> <span class="va">Species</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sepal.Length  Sepal.Width  Petal.Width      Species </span></span>
<span><span class="co">#&gt;            1            2            4            5</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="renaming-variables">Renaming variables<a class="anchor" aria-label="anchor" href="#renaming-variables"></a>
</h3>
<div class="section level4">
<h4 id="name-combination-and-propagation">Name combination and propagation<a class="anchor" aria-label="anchor" href="#name-combination-and-propagation"></a>
</h4>
<p>When named inputs are provided in <code>...</code> or
<code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>, the selection is renamed. If the inputs are already
named, the outer and inner names are <strong>combined</strong> with a
<code>...</code> separator:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>bar <span class="op">=</span> <span class="va">mpg</span>, baz <span class="op">=</span> <span class="va">cyl</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; foo...bar foo...baz </span></span>
<span><span class="co">#&gt;         1         2</span></span></code></pre></div>
<p>Otherwise the outer names is <strong>propagated</strong> to the
selected elements according to the following rules:</p>
<ul>
<li>
<p>With data frames, a numeric suffix is appended because columns
must be uniquely named.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">cyl</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; foo1 foo2 </span></span>
<span><span class="co">#&gt;    1    2</span></span></code></pre></div>
</li>
<li>
<p>With normal vectors, the name is simply assigned to all selected
inputs.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">cyl</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; foo foo </span></span>
<span><span class="co">#&gt;   1   2</span></span></code></pre></div>
</li>
</ul>
<p>Combination and propagation can be composed by using nested
<code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; foo...bar1 foo...bar2 </span></span>
<span><span class="co">#&gt;          1          2</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="set-combination-with-named-variables">Set combination with named variables<a class="anchor" aria-label="anchor" href="#set-combination-with-named-variables"></a>
</h4>
<p>Named elements have special rules to determine their identities in a
set. Unnamed elements match any names:</p>
<ul>
<li>
<code>a | c(foo = a)</code> is equivalent to
<code>c(foo = a)</code>.</li>
<li>
<code>a &amp; c(foo = a)</code> is equivalent to
<code>c(foo = a)</code>.</li>
</ul>
<p>Named elements with different names are distinct:</p>
<ul>
<li>
<code>c(foo = a) &amp; c(bar = a)</code> is equivalent to
<code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>.</li>
<li>
<code>c(foo = a) | c(bar = a)</code> is equivalent to
<code>c(foo = a, bar = a)</code>.</li>
</ul>
<p>Because unnamed elements match any named ones, it is possible to
select multiple elements and rename one of them:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="op">!</span><span class="va">Species</span>, foo <span class="op">=</span> <span class="va">Sepal.Width</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sepal.Length          foo Petal.Length  Petal.Width </span></span>
<span><span class="co">#&gt;            1            2            3            4</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="predicate-functions">Predicate functions<a class="anchor" aria-label="anchor" href="#predicate-functions"></a>
</h3>
<p>Predicate function objects can be supplied as input in an
env-expression, typically with the selection helper
<code><a href="../reference/where.html">where()</a></code>. They are applied to all elements of the data, and
should return <code>TRUE</code> or <code>FALSE</code> to indicate
inclusion. Predicates in env-expressions are effectively expanded to the
set of variables that they represent:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fu"><a href="../reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sepal.Length  Sepal.Width Petal.Length  Petal.Width </span></span>
<span><span class="co">#&gt;            1            2            3            4</span></span>
<span></span>
<span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fu"><a href="../reference/where.html">where</a></span><span class="op">(</span><span class="va">is.factor</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Species </span></span>
<span><span class="co">#&gt;       5</span></span>
<span></span>
<span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fu"><a href="../reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="../reference/where.html">where</a></span><span class="op">(</span><span class="va">is.factor</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species </span></span>
<span><span class="co">#&gt;            1            2            3            4            5</span></span>
<span></span>
<span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fu"><a href="../reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="../reference/where.html">where</a></span><span class="op">(</span><span class="va">is.factor</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; named integer(0)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="selection-helpers">Selection helpers<a class="anchor" aria-label="anchor" href="#selection-helpers"></a>
</h2>
<p>We call <em>selection helpers</em> any function that inspects the
currently active variables with <code><a href="../reference/peek_vars.html">peek_vars()</a></code> and returns a
selection.</p>
<ul>
<li>
<code><a href="../reference/peek_vars.html">peek_vars()</a></code> returns a character vector of names.</li>
<li>The returned selection can be any output conforming to the types
described in the Data types section.</li>
</ul>
<p>Examples of selection helpers are <code><a href="../reference/all_of.html">all_of()</a></code>,
<code><a href="../reference/starts_with.html">contains()</a></code>, or <code><a href="../reference/everything.html">last_col()</a></code>. These selection
helpers are evaluated as env-expressions (see Evaluation section).</p>
</div>
<div class="section level2">
<h2 id="supported-data-types">Supported data types<a class="anchor" aria-label="anchor" href="#supported-data-types"></a>
</h2>
<p>The following data types can be returned from selection helpers or
forced via <code>!!</code> or <code><a href="https://rdrr.io/r/base/force.html" class="external-link">force()</a></code> (the latter works in
tidyselect because it is treated as an env-expression, see Evaluation
section):</p>
<ul>
<li>
<p>Vectors of locations:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/force.html" class="external-link">force</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sepal.Length Petal.Length </span></span>
<span><span class="co">#&gt;            1            3</span></span></code></pre></div>
</li>
<li>
<p>Vectors of names. These are matched and transformed to
locations.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/force.html" class="external-link">force</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sepal.Length"</span>, <span class="st">"Petal.Length"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sepal.Length Petal.Length </span></span>
<span><span class="co">#&gt;            1            3</span></span></code></pre></div>
</li>
<li>
<p>Predicate functions. These are applied to all elements to
determine inclusion.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/force.html" class="external-link">force</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sepal.Length  Sepal.Width Petal.Length  Petal.Width </span></span>
<span><span class="co">#&gt;            1            2            3            4</span></span></code></pre></div>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="evaluation">Evaluation<a class="anchor" aria-label="anchor" href="#evaluation"></a>
</h2>
<div class="section level3">
<h3 id="data-expressions-and-env-expressions">Data-expressions and env-expressions<a class="anchor" aria-label="anchor" href="#data-expressions-and-env-expressions"></a>
</h3>
<p>tidyselect is not a typical tidy evaluation UI. The main difference
is that there is no data masking. In a typical tidy eval function,
expressions are evaluated with data-vars first in scope, followed by
env-vars:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mask</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">expr</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/eval_tidy.html" class="external-link">eval_tidy</a></span><span class="op">(</span><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/enquo.html" class="external-link">enquo</a></span><span class="op">(</span><span class="va">expr</span><span class="op">)</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">foo</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">cyl</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="co"># `cyl` represents the data frame column here:</span></span>
<span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">mask</span><span class="op">(</span><span class="va">cyl</span> <span class="op">*</span> <span class="va">foo</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 60 60 40 60 80 60 80 40 40 60 60 80 80 80 80 80 80 40 40 40 40 80</span></span>
<span><span class="co">#&gt; [23] 80 80 80 40 40 40 80 60 80 40</span></span></code></pre></div>
<p>It is possible to bypass the data frame variables by forcing symbols
to be looked up in the environment with <code>!!</code> or
<code>.env</code>:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">mask</span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">cyl</span> <span class="op">*</span> <span class="va">foo</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2000</span></span>
<span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">mask</span><span class="op">(</span><span class="va">.env</span><span class="op">$</span><span class="va">cyl</span> <span class="op">*</span> <span class="va">foo</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2000</span></span></code></pre></div>
<p>With tidyselect, there is no such hierarchical data masking. Instead,
expressions are evaluated either in the context of the data frame or in
the user environment, without overlap. The scope of lookup depends on
the kind of expression:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>data-expressions</strong> are evaluated in the data frame
only. This includes bare symbols, the boolean operators, <code>-</code>,
<code>:</code>, and <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>. You can’t refer to
environment-variables in a data-expression:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cyl_pos</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="va">mpg</span> <span class="op">|</span> <span class="va">cyl_pos</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `select_loc()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Can't select columns that don't exist.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> Column `cyl_pos` doesn't exist.</span></span></code></pre></div>
</li>
<li>
<p><strong>env-expressions</strong> are evaluated in the
environment. This includes all calls other than those mentioned above,
as well as symbols that are part of those calls. You can’t refer to
data-variables in a data-expression:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fu"><a href="../reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `select_loc()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> In argument: `all_of(mpg)`.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Caused by error:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> object 'mpg' not found</span></span></code></pre></div>
</li>
</ol>
<p>Because the scoping is unambiguous, you can safely refer to env-vars
in an env-expression, without having to worry about potential naming
clashes with data-vars:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">6</span>, z <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># `ncol(x)` is an env-expression, so `x` represents the data frame in</span></span>
<span><span class="co"># the environment rather than the column in the data frame</span></span>
<span><span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; y z </span></span>
<span><span class="co">#&gt; 2 3</span></span></code></pre></div>
<p>If you have variable names in a character vector, it is safe to refer
to the env-var containing the names with <code><a href="../reference/all_of.html">all_of()</a></code> because
it is an env-expression:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="fu"><a href="../reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; y z </span></span>
<span><span class="co">#&gt; 2 3</span></span></code></pre></div>
<p>Note that currently, env-vars are still allowed in some
data-expressions, for compatibility. However this is in the process of
being deprecated and you should see a note recommending to use
<code><a href="../reference/all_of.html">all_of()</a></code> instead. This note will become a deprecation
warning in the future, and then an error.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="va">cyl_pos</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using an external vector in selections was deprecated in tidyselect</span></span>
<span><span class="co">#&gt; 1.1.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `all_of()` or `any_of()` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> See</span></span>
<span><span class="co">#&gt;   &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">was generated.</span></span></span>
<span><span class="co">#&gt; cyl </span></span>
<span><span class="co">#&gt;   2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="arithmetic-operators">Arithmetic operators<a class="anchor" aria-label="anchor" href="#arithmetic-operators"></a>
</h3>
<p>Within data-expressions (see Evaluation section), <code>+</code>,
<code>*</code> and <code>/</code> are overridden to cause an error. This
is to prevent confusion stemming from normal data masking usage where
variables can be transformed on the fly:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="va">cyl</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `select_loc()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Can't use arithmetic operator `^` in selection context.</span></span>
<span></span>
<span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="va">mpg</span> <span class="op">*</span> <span class="va">wt</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `select_loc()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Can't use arithmetic operator `*` in selection context.</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="selecting-versus-renaming">Selecting versus renaming<a class="anchor" aria-label="anchor" href="#selecting-versus-renaming"></a>
</h2>
<p>The select and rename variants take the same types of inputs and have
the same type of return value. They have a few important
differences.</p>
<div class="section level3">
<h3 id="all-renaming-inputs-must-be-named">All renaming inputs must be named<a class="anchor" aria-label="anchor" href="#all-renaming-inputs-must-be-named"></a>
</h3>
<p>Unlike <code><a href="../reference/eval_select.html">eval_select()</a></code> which can select without renaming,
<code><a href="../reference/eval_select.html">eval_rename()</a></code> expects a fully named selection. If one or
several names are missing, an error is thrown.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span></span>
<span><span class="co">#&gt; mpg </span></span>
<span><span class="co">#&gt;   1</span></span>
<span></span>
<span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">rename_loc</span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `rename_loc()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> All renaming inputs must be named.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="renaming-to-an-existing-variable-name">Renaming to an existing variable name<a class="anchor" aria-label="anchor" href="#renaming-to-an-existing-variable-name"></a>
</h3>
<p>If the input data is a data frame, tidyselect generally throws an
error when duplicate column names are selected, in order to respect the
invariant of unique column names.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lists can have duplicates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span>foo <span class="op">=</span> <span class="va">mpg</span>, foo <span class="op">=</span> <span class="va">cyl</span><span class="op">)</span></span>
<span><span class="co">#&gt; foo foo </span></span>
<span><span class="co">#&gt;   1   2</span></span>
<span></span>
<span><span class="co"># Data frames cannot</span></span>
<span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span>foo <span class="op">=</span> <span class="va">mpg</span>, foo <span class="op">=</span> <span class="va">cyl</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `select_loc()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Names must be unique.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> These names are duplicated:</span></span>
<span><span class="co">#&gt;   * "foo" at locations 1 and 2.</span></span></code></pre></div>
<p>A selection can rename a variable to an existing name if the latter
is not part of the selection:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="va">cyl</span>, cyl <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `select_loc()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Names must be unique.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> These names are duplicated:</span></span>
<span><span class="co">#&gt;   * "cyl" at locations 1 and 2.</span></span>
<span></span>
<span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="va">disp</span>, cyl <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span></span>
<span><span class="co">#&gt; disp  cyl </span></span>
<span><span class="co">#&gt;    3    1</span></span></code></pre></div>
<p>This is not possible when renaming.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">rename_loc</span><span class="op">(</span><span class="va">cyl</span>, cyl <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `rename_loc()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> All renaming inputs must be named.</span></span>
<span></span>
<span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">rename_loc</span><span class="op">(</span><span class="va">disp</span>, cyl <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `rename_loc()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> All renaming inputs must be named.</span></span></code></pre></div>
<p>However, the name conflict can be solved by renaming the existing
variable to another name:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span>foo <span class="op">=</span> <span class="va">cyl</span>, cyl <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span></span>
<span><span class="co">#&gt; foo cyl </span></span>
<span><span class="co">#&gt;   2   1</span></span>
<span></span>
<span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">rename_loc</span><span class="op">(</span>foo <span class="op">=</span> <span class="va">cyl</span>, cyl <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span></span>
<span><span class="co">#&gt; foo cyl </span></span>
<span><span class="co">#&gt;   2   1</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="duplicate-columns-in-data-frames">Duplicate columns in data frames<a class="anchor" aria-label="anchor" href="#duplicate-columns-in-data-frames"></a>
</h2>
<p>Normally a data frame shouldn’t have duplicate names. However, the
real world is messy and duplicates do happen in the wild. tidyselect
tries to be as permissive as it can with these duplicates so that users
can restore unique names with <code>select()</code> or
<code>rename()</code>.</p>
<p>First let’s create a data frame with duplicate names:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dups</span> <span class="op">&lt;-</span> <span class="fu">vctrs</span><span class="fu">::</span><span class="fu"><a href="https://vctrs.r-lib.org/reference/new_data_frame.html" class="external-link">new_data_frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">2</span>, x <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>If the duplicates are not part of the selection, they are simply
ignored:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dups</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="co">#&gt; y </span></span>
<span><span class="co">#&gt; 2</span></span></code></pre></div>
<p>If the duplicates are selected, this is an error:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dups</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `select_loc()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Names must be unique.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> These names are duplicated:</span></span>
<span><span class="co">#&gt;   * "x" at locations 1 and 2.</span></span></code></pre></div>
<p>The duplicate names can be repaired by renaming chosen locations:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dups</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select_loc</span><span class="op">(</span><span class="va">x</span>, foo <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   x foo </span></span>
<span><span class="co">#&gt;   1   3</span></span>
<span></span>
<span><span class="va">dups</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">rename_loc</span><span class="op">(</span>foo <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; foo </span></span>
<span><span class="co">#&gt;   3</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>The tidyselect syntax was inspired by the <code><a href="https://rdrr.io/r/base/subset.html" class="external-link">base::subset()</a></code>
function written by Peter Dalgaard. The <code>select</code> parameter of
<code><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset.data.frame()</a></code> is evaluated in a data mask where the
column names are bound to their locations in the data frame. This allows
<code>:</code> to create sequences of variable locations. The locations
can be combined with <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>. This selection interface set the
tone for the development of the tidyselect syntax.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cyl</span>, <span class="va">hp</span><span class="op">:</span><span class="va">wt</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 32 × 4</span></span></span>
<span><span class="co">#&gt;     cyl    hp  drat    wt</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     6   110  3.9   2.62</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     6   110  3.9   2.88</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     4    93  3.85  2.32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     6   110  3.08  3.22</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 28 more rows</span></span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/lionel-" class="external-link">Lionel Henry</a>, <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

  </div></footer>
</body>
</html>
